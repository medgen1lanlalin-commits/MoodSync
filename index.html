  }
  .animate-fade-in {
    animation: fadeIn 0.5s ease-out;
  }
  .animate-slide-up {
    animation: slideUp 0.5s ease-out;
  }
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  @keyframes slideUp {
    from { transform: translateY(20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }
  .scrollbar-hide::-webkit-scrollbar {
      display: none;
  }
  .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
  }
`;

// --- Components ---

// 1. Navigation Bar
const BottomNav = ({ activeTab, setActiveTab }) => {
  const tabs = [
    { id: 'dashboard', icon: <Heart size={24} />, label: '‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å' },
    { id: 'log', icon: <Plus size={24} />, label: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å' },
    { id: 'analysis', icon: <BarChart2 size={24} />, label: '‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå' },
    { id: 'community', icon: <Users size={24} />, label: '‡∏ä‡∏∏‡∏°‡∏ä‡∏ô' },
  ];

  return (
    <div className="fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-md border-t border-pink-100 p-4 pb-6 flex justify-around items-center z-50 rounded-t-3xl shadow-[0_-5px_20px_rgba(255,192,203,0.3)]">
      {tabs.map((tab) => (
        <button
          key={tab.id}
          onClick={() => setActiveTab(tab.id)}
          className={`flex flex-col items-center transition-all duration-300 ${
            activeTab === tab.id ? 'text-pink-500 scale-110' : 'text-gray-400'
          }`}
        >
          <div className={`${activeTab === tab.id ? 'bg-pink-100 p-2 rounded-full' : ''}`}>
            {tab.icon}
          </div>
          <span className="text-xs mt-1 font-medium">{tab.label}</span>
        </button>
      ))}
    </div>
  );
};

// 2. Dashboard Component
const Dashboard = ({ logs, setActiveTab }) => {
  const [hrv, setHrv] = useState(null);
  const [syncing, setSyncing] = useState(false);

  const simulateSync = () => {
    setSyncing(true);
    setTimeout(() => {
      setHrv(Math.floor(Math.random() * (80 - 40 + 1) + 40)); // Random HRV 40-80
      setSyncing(false);
    }, 2000);
  };

  const lastMood = logs.length > 0 ? logs[0].mood : 3;
  const moodText = ['‡πÅ‡∏¢‡πà‡∏°‡∏≤‡∏Å', '‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡∏î‡∏µ', '‡πÄ‡∏â‡∏¢‡πÜ', '‡∏î‡∏µ', '‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç'][lastMood - 1] || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';

  return (
    <div className="p-6 space-y-6 pb-24 animate-fade-in">
      {/* Header */}
      <div className="flex justify-between items-center">
        <div>
          <h1 className="text-3xl font-bold text-gray-800">MoodSync</h1>
          <p className="text-pink-400 text-sm">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
        </div>
        <div className="bg-pink-100 p-2 rounded-full">
          <Brain className="text-pink-500" size={24} />
        </div>
      </div>

      {/* Mood Card */}
      <div className="bg-gradient-to-br from-pink-400 to-rose-400 rounded-3xl p-6 text-white shadow-lg shadow-pink-200">
        <div className="flex justify-between items-start">
          <div>
            <p className="opacity-90 text-sm mb-1">‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
            <h2 className="text-2xl font-bold">{moodText}</h2>
          </div>
          <div className="bg-white/20 p-2 rounded-xl backdrop-blur-sm">
            {lastMood >= 4 ? <Smile size={32} /> : lastMood <= 2 ? <Frown size={32} /> : <Meh size={32} />}
          </div>
        </div>
        
        <div className="mt-6 pt-4 border-t border-white/20">
           <p className="text-sm font-medium mb-2 flex items-center gap-2">
             <Utensils size={16} /> ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ (Nutritional Prescription)
           </p>
           <div className="bg-white/90 text-pink-600 rounded-xl p-3 text-sm font-semibold shadow-sm">
             {lastMood <= 2 
               ? "üçì ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏≤‡∏£‡πå‡∏Å‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï ‡∏ä‡πà‡∏ß‡∏¢‡∏ö‡∏π‡∏™‡∏ï‡πå Endorphins" 
               : "ü•ë ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏≠‡∏∞‡πÇ‡∏ß‡∏Ñ‡∏≤‡πÇ‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡∏±‡πà‡∏ß ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô (Low GI)"}
           </div>
        </div>
      </div>

      {/* Bio-Feedback Integration */}
      <div className="bg-white rounded-3xl p-6 shadow-sm border border-pink-50">
        <div className="flex justify-between items-center mb-4">
          <h3 className="font-bold text-gray-700 flex items-center gap-2">
            <Activity className="text-pink-500" size={20} /> Bio-Feedback
          </h3>
          <button 
            onClick={simulateSync}
            disabled={syncing}
            className="text-xs bg-gray-100 hover:bg-gray-200 text-gray-600 px-3 py-1 rounded-full flex items-center gap-1 transition-colors"
          >
            <Watch size={12} /> {syncing ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå...' : 'Sync Watch'}
          </button>
        </div>
        
        <div className="flex items-center justify-between">
           <div className="text-center w-full">
              <span className="text-gray-400 text-xs uppercase tracking-wider">HRV Stress Level</span>
              <div className="flex justify-center items-end gap-2 mt-1">
                 <span className="text-4xl font-bold text-gray-800">
                   {hrv ? hrv : '--'}
                 </span>
                 <span className="text-sm text-gray-400 mb-1">ms</span>
              </div>
              <p className="text-xs text-pink-400 mt-2">
                {hrv ? (hrv < 50 ? '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡∏™‡∏π‡∏á ‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡∏∞' : '‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢‡∏î‡∏µ') : '‡∏Å‡∏î Sync ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡πà‡∏≤'}
              </p>
           </div>
        </div>
      </div>

      {/* Quick Actions */}
      <div className="grid grid-cols-2 gap-4">
        <button onClick={() => setActiveTab('log')} className="bg-white p-4 rounded-2xl shadow-sm border border-pink-50 flex flex-col items-center justify-center gap-2 hover:bg-pink-50 transition-colors">
          <div className="bg-green-100 p-3 rounded-full text-green-600">
            <Leaf size={24} />
          </div>
          <span className="text-sm font-medium text-gray-600">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£</span>
        </button>
        <button onClick={() => setActiveTab('log')} className="bg-white p-4 rounded-2xl shadow-sm border border-pink-50 flex flex-col items-center justify-center gap-2 hover:bg-pink-50 transition-colors">
          <div className="bg-purple-100 p-3 rounded-full text-purple-600">
            <Moon size={24} />
          </div>
          <span className="text-sm font-medium text-gray-600">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏≥‡πÑ‡∏™‡πâ</span>
        </button>
      </div>
    </div>
  );
};

// 3. Logger Component
const Logger = ({ addLog, setActiveTab }) => {
  const [step, setStep] = useState(1);
  const [mood, setMood] = useState(3);
  const [food, setFood] = useState('');
  const [nutrients, setNutrients] = useState([]);
  const [gutStatus, setGutStatus] = useState('normal');

  const toggleNutrient = (n) => {
    if (nutrients.includes(n)) {
      setNutrients(nutrients.filter(item => item !== n));
    } else {
      setNutrients([...nutrients, n]);
    }
  };

  const handleSave = () => {
    addLog({
      mood,
      food,
      nutrients,
      gutStatus,
      timestamp: new Date().toISOString()
    });
    setActiveTab('dashboard');
  };

  return (
    <div className="p-6 pb-24 animate-slide-up">
      <h2 className="text-2xl font-bold text-gray-800 mb-6 text-center">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h2>
      
      {/* Progress Bar */}
      <div className="flex gap-2 mb-8 justify-center">
        {[1, 2, 3].map(i => (
          <div key={i} className={`h-2 w-8 rounded-full transition-colors ${step >= i ? 'bg-pink-500' : 'bg-gray-200'}`} />
        ))}
      </div>

      {step === 1 && (
        <div className="space-y-8 text-center">
          <h3 className="text-lg font-medium text-gray-600">‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</h3>
          <div className="flex justify-between items-center px-4">
             {[1, 2, 3, 4, 5].map((score) => (
               <button 
                 key={score}
                 onClick={() => setMood(score)}
                 className={`flex flex-col items-center gap-2 transition-transform ${mood === score ? 'scale-125' : 'opacity-50'}`}
               >
                 <div className={`text-4xl ${mood === score ? 'drop-shadow-lg' : ''}`}>
                   {score === 1 && 'üò´'}
                   {score === 2 && 'üòî'}
                   {score === 3 && 'üòê'}
                   {score === 4 && 'üôÇ'}
                   {score === 5 && 'ü•∞'}
                 </div>
               </button>
             ))}
          </div>
          <div className="text-pink-500 font-medium">
             {['‡πÅ‡∏¢‡πà‡∏°‡∏≤‡∏Å', '‡πÄ‡∏´‡∏ô‡∏∑‡πà‡∏≠‡∏¢/‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î', '‡πÄ‡∏â‡∏¢‡πÜ', '‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô', '‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏™‡∏∏‡∏î‡πÜ'][mood - 1]}
          </div>
          <button onClick={() => setStep(2)} className="w-full bg-pink-500 text-white py-4 rounded-2xl font-bold text-lg shadow-lg hover:bg-pink-600 transition-colors flex items-center justify-center gap-2">
            ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <ArrowRight size={20} />
          </button>
        </div>
      )}

      {step === 2 && (
        <div className="space-y-6">
          <div className="text-center">
             <h3 className="text-lg font-medium text-gray-600">Smart Food Logging</h3>
             <p className="text-xs text-gray-400">‡∏°‡∏∑‡πâ‡∏≠‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≤‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏õ‡∏ö‡πâ‡∏≤‡∏á?</p>
          </div>
          
          <input 
            type="text" 
            placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏¢‡πÄ‡∏Å‡∏¥‡∏£‡πå‡∏ï, ‡∏Ç‡πâ‡∏≤‡∏ß‡∏ú‡∏±‡∏î‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤..."
            value={food}
            onChange={(e) => setFood(e.target.value)}
            className="w-full p-4 rounded-2xl bg-gray-50 border border-gray-200 focus:outline-none focus:ring-2 focus:ring-pink-300"
          />

          <div>
            <p className="text-sm font-medium text-gray-600 mb-3">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</p>
            <div className="flex flex-wrap gap-2">
              <button 
                onClick={() => toggleNutrient('probiotics')}
                className={`px-4 py-2 rounded-xl text-sm border transition-colors ${nutrients.includes('probiotics') ? 'bg-blue-100 border-blue-300 text-blue-700' : 'bg-white border-gray-200 text-gray-500'}`}
              >
                ü¶† Probiotics (‡∏•‡∏≥‡πÑ‡∏™‡πâ)
              </button>
              <button 
                onClick={() => toggleNutrient('magnesium')}
                className={`px-4 py-2 rounded-xl text-sm border transition-colors ${nutrients.includes('magnesium') ? 'bg-purple-100 border-purple-300 text-purple-700' : 'bg-white border-gray-200 text-gray-500'}`}
              >
                üçå Magnesium (‡∏•‡∏î‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î)
              </button>
              <button 
                onClick={() => toggleNutrient('vitB')}
                className={`px-4 py-2 rounded-xl text-sm border transition-colors ${nutrients.includes('vitB') ? 'bg-orange-100 border-orange-300 text-orange-700' : 'bg-white border-gray-200 text-gray-500'}`}
              >
                ‚ö° Vit B6/B12 (‡∏™‡∏°‡∏≠‡∏á)
              </button>
              <button 
                onClick={() => toggleNutrient('highSugar')}
                className={`px-4 py-2 rounded-xl text-sm border transition-colors ${nutrients.includes('highSugar') ? 'bg-red-100 border-red-300 text-red-700' : 'bg-white border-gray-200 text-gray-500'}`}
              >
                üç≠ ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏™‡∏π‡∏á (Sugar Spike)
              </button>
            </div>
          </div>

          <div className="flex gap-4">
            <button onClick={() => setStep(1)} className="flex-1 bg-gray-100 text-gray-600 py-4 rounded-2xl font-bold">‡∏Å‡∏•‡∏±‡∏ö</button>
            <button onClick={() => setStep(3)} className="flex-1 bg-pink-500 text-white py-4 rounded-2xl font-bold shadow-lg">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
          </div>
        </div>
      )}

      {step === 3 && (
        <div className="space-y-8 text-center">
           <div>
             <h3 className="text-lg font-medium text-gray-600">Gut-Check ü©∫</h3>
             <p className="text-sm text-gray-400">‡∏ó‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</p>
           </div>

           <div className="grid grid-cols-2 gap-4">
             {[
               { id: 'normal', label: '‡∏™‡∏ö‡∏≤‡∏¢‡∏ó‡πâ‡∏≠‡∏á', icon: 'üçÉ' },
               { id: 'bloated', label: '‡∏ó‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡∏î', icon: 'üê°' },
               { id: 'constipated', label: '‡∏ó‡πâ‡∏≠‡∏á‡∏ú‡∏π‡∏Å', icon: 'üß±' },
               { id: 'loose', label: '‡∏ó‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢', icon: 'üåä' }
             ].map((option) => (
               <button
                 key={option.id}
                 onClick={() => setGutStatus(option.id)}
                 className={`p-4 rounded-2xl border-2 transition-all ${gutStatus === option.id ? 'border-pink-500 bg-pink-50' : 'border-gray-100 bg-white'}`}
               >
                 <div className="text-3xl mb-2">{option.icon}</div>
                 <div className="text-sm font-medium text-gray-700">{option.label}</div>
               </button>
             ))}
           </div>

           <button onClick={handleSave} className="w-full bg-pink-500 text-white py-4 rounded-2xl font-bold text-lg shadow-lg hover:bg-pink-600 transition-colors flex items-center justify-center gap-2">
            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• <Activity size={20} />
          </button>
        </div>
      )}
    </div>
  );
};

// 4. Analysis Component (AI Insight)
const Analysis = ({ logs }) => {
  const [insight, setInsight] = useState(null);

  // Simple heuristic AI simulation
  useEffect(() => {
    if (logs.length < 3) {
      setInsight({ title: "‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°", desc: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏µ‡∏Å 2-3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå" });
      return;
    }

    // Logic: Check for Sugar Crash
    const sugarLogs = logs.filter(l => l.nutrients.includes('highSugar'));
    const badMoodAfterSugar = sugarLogs.filter(l => l.mood <= 2).length;

    // Logic: Check for Probiotics Benefit
    const proLogs = logs.filter(l => l.nutrients.includes('probiotics'));
    const goodMoodAfterPro = proLogs.filter(l => l.mood >= 4).length;

    if (sugarLogs.length > 0 && badMoodAfterSugar / sugarLogs.length > 0.5) {
      setInsight({ 
        title: "‚ö†Ô∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö Sugar Crash", 
        desc: "AI ‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏î‡∏¥‡πà‡∏á‡∏•‡∏á‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏™‡∏π‡∏á ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏•‡∏î‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ö‡πà‡∏≤‡∏¢",
        type: 'warning'
      });
    } else if (proLogs.length > 0 && goodMoodAfterPro / proLogs.length > 0.5) {
      setInsight({ 
        title: "‚ú® Gut-Brain Axis ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ", 
        desc: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏ô Probiotics ‡∏î‡∏π‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏à‡∏∞‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏ó‡∏≥‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏∞!",
        type: 'success'
      });
    } else {
      setInsight({ 
        title: "üìä ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•", 
        desc: "‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡πâ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠",
        type: 'neutral'
      });
    }
  }, [logs]);

  return (
    <div className="p-6 pb-24 space-y-6 animate-fade-in">
      <h2 className="text-2xl font-bold text-gray-800">AI Insight Analysis</h2>
      
      {/* Insight Card */}
      {insight && (
        <div className={`p-6 rounded-3xl border ${
          insight.type === 'warning' ? 'bg-orange-50 border-orange-200' :
          insight.type === 'success' ? 'bg-green-50 border-green-200' :
          'bg-blue-50 border-blue-200'
        }`}>
          <div className="flex items-start gap-4">
             <div className={`p-3 rounded-full ${
                insight.type === 'warning' ? 'bg-orange-100 text-orange-600' :
                insight.type === 'success' ? 'bg-green-100 text-green-600' :
                'bg-blue-100 text-blue-600'
             }`}>
               {insight.type === 'warning' ? <AlertCircle size={24} /> : <Brain size={24} />}
             </div>
             <div>
               <h3 className="font-bold text-gray-800 mb-1">{insight.title}</h3>
               <p className="text-sm text-gray-600 leading-relaxed">{insight.desc}</p>
             </div>
          </div>
        </div>
      )}

      {/* Simplified Graph Representation */}
      <div className="bg-white p-6 rounded-3xl shadow-sm border border-gray-100">
        <h3 className="font-bold text-gray-700 mb-4 flex items-center gap-2">
          <TrendingUp size={20} className="text-pink-500" /> ‡∏Å‡∏£‡∏≤‡∏ü‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ
        </h3>
        <div className="h-40 flex items-end justify-between gap-2 px-2">
          {logs.slice(-7).map((log, i) => (
            <div key={i} className="flex flex-col items-center gap-2 w-full">
               <div 
                 className={`w-full rounded-t-lg transition-all duration-1000 ${log.mood >= 4 ? 'bg-green-400' : log.mood <= 2 ? 'bg-orange-400' : 'bg-blue-300'}`}
                 style={{ height: `${log.mood * 20}%` }}
               ></div>
               <span className="text-xs text-gray-400">
                 {new Date(log.timestamp).getDate()}
               </span>
            </div>
          ))}
          {logs.length === 0 && <div className="w-full h-full flex items-center justify-center text-gray-400 text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>}
        </div>
      </div>

       {/* Food-Mood Index */}
       <div className="bg-white p-6 rounded-3xl shadow-sm border border-gray-100">
         <h3 className="font-bold text-gray-700 mb-2">Food-Mood Index</h3>
         <p className="text-xs text-gray-500 mb-4">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏à‡∏≤‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
         <div className="flex items-center gap-4">
           <div className="w-16 h-16 rounded-full border-4 border-pink-500 flex items-center justify-center text-xl font-bold text-pink-600">
             7.5
           </div>
           <div className="text-sm text-gray-600">
             <p>‡∏£‡∏∞‡∏î‡∏±‡∏ö: <span className="text-green-500 font-bold">‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏î‡∏µ</span></p>
             <p className="text-xs mt-1">‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ö‡∏ß‡∏Å‡∏ï‡πà‡∏≠‡∏à‡∏¥‡∏ï‡πÉ‡∏à</p>
           </div>
         </div>
       </div>
       
       {/* Depression Risk Screening CTA */}
       <button className="w-full bg-indigo-50 text-indigo-600 py-3 rounded-xl text-sm font-semibold border border-indigo-100 flex items-center justify-center gap-2">
         <Activity size={16} /> ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏†‡∏≤‡∏ß‡∏∞‡∏ã‡∏∂‡∏°‡πÄ‡∏®‡∏£‡πâ‡∏≤ (PHQ-9)
       </button>
    </div>
  );
};

// 5. Community Component
const Community = () => {
  const posts = [
    { id: 1, user: 'Ploy_Healthy', tag: '#MenuForAnxiety', title: '‡∏™‡∏°‡∏π‡∏ó‡∏ï‡∏µ‡πâ‡∏Å‡∏•‡πâ‡∏ß‡∏¢+‡∏≠‡∏±‡∏•‡∏°‡∏≠‡∏ô‡∏î‡πå', desc: '‡πÅ‡∏Å‡πâ‡∏ß‡∏ô‡∏µ‡πâ‡∏Å‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏•‡∏±‡∏ö‡∏™‡∏ö‡∏≤‡∏¢‡∏°‡∏≤‡∏Å ‡∏°‡∏µ‡πÅ‡∏°‡∏Å‡∏ô‡∏µ‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏™‡∏π‡∏á‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏•‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡∏Ñ‡πà‡∏∞', likes: 124 },
    { id: 2, user: 'Dave_Fit', tag: '#MondayMotivation', title: '‡∏≠‡∏Å‡πÑ‡∏Å‡πà‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏°‡∏¥‡πâ‡∏ô', desc: '‡∏Ç‡∏°‡∏¥‡πâ‡∏ô‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡πÉ‡∏ô‡∏•‡∏≥‡πÑ‡∏™‡πâ ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏î‡∏µ‡∏ï‡πà‡∏≠‡∏™‡∏°‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö', likes: 89 },
    { id: 3, user: 'MindfulEater', tag: '#GutHealth', title: '‡πÇ‡∏¢‡πÄ‡∏Å‡∏¥‡∏£‡πå‡∏ï‡πÇ‡∏Æ‡∏°‡πÄ‡∏°‡∏î', desc: '‡∏ó‡∏≥‡πÄ‡∏≠‡∏á‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡πÇ‡∏õ‡∏£‡πÑ‡∏ö‡πÇ‡∏≠‡∏ï‡∏¥‡∏Å‡∏™‡πå‡πÄ‡∏û‡∏µ‡∏¢‡∏ö ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏î‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô', likes: 210 },
  ];

  return (
    <div className="p-6 pb-24 space-y-6 animate-fade-in">
       <div className="flex justify-between items-center">
         <h2 className="text-2xl font-bold text-gray-800">Community</h2>
         <button className="bg-pink-500 text-white p-2 rounded-full shadow-md"><Plus size={20} /></button>
       </div>
       
       <div className="flex gap-2 overflow-x-auto pb-2 scrollbar-hide">
         <span className="bg-pink-100 text-pink-600 px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap">#MenuForAnxiety</span>
         <span className="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap">#MondayMotivation</span>
         <span className="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap">#GutHealth</span>
       </div>

       <div className="space-y-4">
         {posts.map(post => (
           <div key={post.id} className="bg-white p-4 rounded-3xl shadow-sm border border-pink-50 hover:shadow-md transition-shadow">
              <div className="flex justify-between items-start mb-2">
                 <div className="flex items-center gap-2">
                   <div className="w-8 h-8 bg-gray-200 rounded-full"></div>
                   <span className="text-sm font-bold text-gray-700">{post.user}</span>
                 </div>
                 <span className="text-xs bg-pink-50 text-pink-500 px-2 py-1 rounded-lg">{post.tag}</span>
              </div>
              <h3 className="font-bold text-gray-800">{post.title}</h3>
              <p className="text-sm text-gray-500 mt-1">{post.desc}</p>
              <div className="mt-3 flex items-center gap-1 text-pink-400 text-xs font-medium">
                 <Heart size={14} className="fill-current" /> {post.likes}
              </div>
           </div>
         ))}
       </div>
    </div>
  );
};

// --- Main App Component ---

const App = () => {
  const [activeTab, setActiveTab] = useState('dashboard');
  
  // Fake persistent storage
  const [logs, setLogs] = useState([
    { mood: 3, food: '‡∏Å‡∏≤‡πÅ‡∏ü‡∏î‡∏≥', nutrients: [], gutStatus: 'normal', timestamp: '2023-10-24T08:00:00' },
    { mood: 4, food: '‡∏™‡∏•‡∏±‡∏î‡πÅ‡∏ã‡∏•‡∏°‡∏≠‡∏ô', nutrients: ['vitB', 'magnesium'], gutStatus: 'normal', timestamp: '2023-10-24T12:00:00' },
    { mood: 2, food: '‡∏ö‡∏¥‡∏á‡∏ã‡∏π', nutrients: ['highSugar'], gutStatus: 'bloated', timestamp: '2023-10-24T15:00:00' },
  ]);

  const addLog = (newLog) => {
    setLogs([newLog, ...logs]);
  };

  return (
    <>
      <style>{styles}</style>
      <div className="min-h-screen bg-[#FFF0F5] font-sans text-gray-800 flex justify-center">
        {/* Mobile Container Limit */}
        <div className="w-full max-w-md bg-white min-h-screen shadow-2xl relative overflow-hidden">
          
          {/* Decorative Background Elements */}
          <div className="absolute top-[-10%] right-[-20%] w-64 h-64 bg-pink-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob"></div>
          <div className="absolute top-[-10%] left-[-20%] w-64 h-64 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000"></div>
          <div className="absolute bottom-[-10%] left-[20%] w-64 h-64 bg-yellow-100 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob animation-delay-4000"></div>

          {/* Content Area */}
          <div className="relative z-10 h-full overflow-y-auto scrollbar-hide">
            {activeTab === 'dashboard' && <Dashboard logs={logs} setActiveTab={setActiveTab} />}
            {activeTab === 'log' && <Logger addLog={addLog} setActiveTab={setActiveTab} />}
            {activeTab === 'analysis' && <Analysis logs={logs} />}
            {activeTab === 'community' && <Community />}
          </div>

          {/* Navigation */}
          <BottomNav activeTab={activeTab} setActiveTab={setActiveTab} />
        </div>
      </div>
    </>
  );
};

export default App;
